{
  "test_suite": "catalogd",
  "timestamp": 1760622359.731305,
  "configuration": {
    "openshift_url": "https://api.example.com:6443",
    "skip_tls": true,
    "test_catalog": "openshift-redhat-operators",
    "test_package": "quay-operator",
    "test_channel": "stable-3.10",
    "test_version": "3.10.0"
  },
  "results": [
    {
      "test": "basic_catalogd_help",
      "success": true,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:55 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:55 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\nNo catalogd operation specified. Use 'rbac-manager catalogd --help' to see available options.\n\n",
        "stderr": "",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "list_catalogs_command",
      "success": true,
      "details": {
        "exit_code": 0,
        "stdout": "2025-10-16 16:45:55 - WARNING - SSL verification disabled - connections will not verify certificates. This is insecure and should only be used in development environments\n2025-10-16 16:45:55 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:55 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:55 - INFO - Fetching ClusterCatalogs from the cluster...\n2025-10-16 16:45:55 - INFO - Found 4 ClusterCatalogs\n[\n  {\n    \"name\": \"openshift-certified-operators\",\n    \"serving\": true,\n    \"age\": \"2h\",\n    \"status\": \"Serving\"\n  },\n  {\n    \"name\": \"openshift-community-operators\",\n    \"serving\": true,\n    \"age\": \"2h\",\n    \"status\": \"Serving\"\n  },\n  {\n    \"name\": \"openshift-redhat-marketplace\",\n    \"serving\": true,\n    \"age\": \"2h\",\n    \"status\": \"Serving\"\n  },\n  {\n    \"name\": \"openshift-redhat-operators\",\n    \"serving\": true,\n    \"age\": \"2h\",\n    \"status\": \"Serving\"\n  }\n]\n",
        "stderr": "",
        "has_catalog_output": true,
        "command": "python3 tools/rbac-manager/rbac-manager.py list-catalogs --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls"
      }
    },
    {
      "test": "list_packages",
      "success": false,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:55 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:55 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:55 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:55 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'bf5ab2c3-a0d0-493b-82c3-d3a9b31123e6', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:55 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:55 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'bf5ab2c3-a0d0-493b-82c3-d3a9b31123e6', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:55 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'bf5ab2c3-a0d0-493b-82c3-d3a9b31123e6', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:55 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift-redhat-operators",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "list_channels",
      "success": false,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:55 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:55 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:55 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:56 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'b722c293-9083-422a-9055-f6b73261073f', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:56 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'b722c293-9083-422a-9055-f6b73261073f', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'b722c293-9083-422a-9055-f6b73261073f', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift-redhat-operators --package quay-operator",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "list_versions",
      "success": false,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:56 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:56 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:56 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:56 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '5b898ad3-8716-4084-97f0-da478649a64c', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:56 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '5b898ad3-8716-4084-97f0-da478649a64c', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '5b898ad3-8716-4084-97f0-da478649a64c', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift-redhat-operators --package quay-operator --channel stable-3.10",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "get_metadata",
      "success": false,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:56 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:56 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:56 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:56 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '160301b3-502d-42a9-a89c-17e4632f0fad', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:56 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '160301b3-502d-42a9-a89c-17e4632f0fad', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '160301b3-502d-42a9-a89c-17e4632f0fad', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:56 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift-redhat-operators --package quay-operator --channel stable-3.10 --version 3.10.0",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "generate_config_template",
      "success": true,
      "details": {
        "exit_code": 0,
        "stdout_contains_yaml": true,
        "command": "python3 tools/rbac-manager/rbac-manager.py generate-config",
        "stdout": "# RBAC Manager Configuration File\n# Template for configuring RBAC extraction from operator bundles\noperator:\n  image: quay.io/example/operator-bundle:latest\n  namespace: default\n  channel: '#<VERIFY_WITH_CATALOGD_AND_SET_CHANNEL>'\n  packageName: example-operator\n  version: 1.0.0\noutput:\n  mode: yaml\n  type: yaml\n  path: ./output\nglobal:\n  skip_tls: false\n  debug: false\n\n",
        "stderr": ""
      }
    },
    {
      "test": "generate_config_with_params",
      "success": true,
      "details": {
        "exit_code": 0,
        "has_package_info": true,
        "has_real_bundle_image": false,
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --to-config --catalog-name openshift-redhat-operators --package quay-operator --channel stable-3.10 --version 3.10.0",
        "stdout": "2025-10-16 16:45:57 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:57 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:57 - INFO - Setting up port-forward to catalogd service...\n2025-10-16 16:45:57 - INFO - Setting up port-forward to catalogd service...\n\n\u26a0 Warning: Failed to extract data from catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'ef0f7964-faa2-491d-8fb5-3e064fce9afe', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nUsing placeholder values (check catalogd query output above)\n# RBAC Manager Configuration File\n# Generated from extracted values\noperator:\n  image: quay.io/example/operator-bundle:v1.0.0\n  namespace: default\n  channel: stable-3.10\n  packageName: quay-operator\n  version: 3.10.0\noutput:\n  mode: stdout\n  type: yaml\n  path: ./output\nglobal:\n  skip_tls: false\n  debug: false\n\n",
        "stderr": "2025-10-16 16:45:57 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '8efbd90f-c89d-4059-ace3-d22056e95c30', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '8efbd90f-c89d-4059-ace3-d22056e95c30', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '8efbd90f-c89d-4059-ace3-d22056e95c30', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'ef0f7964-faa2-491d-8fb5-3e064fce9afe', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Failed to extract data from catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'ef0f7964-faa2-491d-8fb5-3e064fce9afe', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n"
      }
    },
    {
      "test": "generate_config_file_output",
      "success": true,
      "details": {
        "exit_code": 0,
        "file_created": true,
        "config_valid": true,
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --to-config --catalog-name openshift-redhat-operators --package quay-operator --channel stable-3.10 --version 3.10.0 --output /tmp/placeholder-output-dir",
        "stdout": "2025-10-16 16:45:57 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:57 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:57 - INFO - Setting up port-forward to catalogd service...\n2025-10-16 16:45:57 - INFO - Setting up port-forward to catalogd service...\n\n\u26a0 Warning: Failed to extract data from catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '77b8e8f3-f3f4-4dbf-80ce-0dd593527f23', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nUsing placeholder values (check catalogd query output above)\n2025-10-16 16:45:57 - INFO - Configuration file written: /var/folders/ss/3vqp2nj14xjbvczs_qw1cl8m0000gn/T/tmp13sc3bti/quay-operator-rbac-config.yaml\n\u2713 Configuration file generated: /var/folders/ss/3vqp2nj14xjbvczs_qw1cl8m0000gn/T/tmp13sc3bti/quay-operator-rbac-config.yaml\n",
        "stderr": "2025-10-16 16:45:57 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '740c7a4a-d4a4-40b9-b1c9-468f7502358a', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '740c7a4a-d4a4-40b9-b1c9-468f7502358a', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '740c7a4a-d4a4-40b9-b1c9-468f7502358a', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '77b8e8f3-f3f4-4dbf-80ce-0dd593527f23', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:57 - ERROR - Failed to extract data from catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '77b8e8f3-f3f4-4dbf-80ce-0dd593527f23', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:57 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n"
      }
    },
    {
      "test": "interactive_catalog_selection",
      "success": false,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:57 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:57 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:57 - INFO - Fetching ClusterCatalogs from the cluster...\n2025-10-16 16:45:57 - INFO - Found 4 ClusterCatalogs\n\nAvailable ClusterCatalogs:\n1. openshift-certified-operators (\u2713 Serving)\n2. openshift-community-operators (\u2713 Serving)\n3. openshift-redhat-marketplace (\u2713 Serving)\n4. openshift-redhat-operators (\u2713 Serving)\n\nSelect a catalog (1-4): 2025-10-16 16:45:57 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:58 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c4f2794e-26ef-44df-8945-70e5f196a0f0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:58 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c4f2794e-26ef-44df-8945-70e5f196a0f0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c4f2794e-26ef-44df-8945-70e5f196a0f0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --package quay-operator",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "invalid_catalog",
      "success": true,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:58 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:58 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:58 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:58 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c78a3b09-dd65-40c1-bef5-37438fc42d71', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:58 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c78a3b09-dd65-40c1-bef5-37438fc42d71', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c78a3b09-dd65-40c1-bef5-37438fc42d71', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:58 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name invalid-catalog-name --package quay-operator",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "misspelled_catalog",
      "success": true,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:58 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:58 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n",
        "stderr": "2025-10-16 16:45:58 - ERROR - Error querying catalogd: Catalog name 'openshiftredhatoperators' appears to be misspelled.\nDid you mean: openshift-redhat-operators?\n\nTo see all available catalogs, run:\n  python3 rbac-manager.py list-catalogs\nError: Catalog name 'openshiftredhatoperators' appears to be misspelled.\nDid you mean: openshift-redhat-operators?\n\nTo see all available catalogs, run:\n  python3 rbac-manager.py list-catalogs\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshiftredhatoperators --package quay-operator",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "invalid_characters_catalog",
      "success": true,
      "duration": 0.0,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:58 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:58 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n",
        "stderr": "2025-10-16 16:45:58 - ERROR - Error querying catalogd: Catalog name 'openshift redhat operators' contains invalid characters.\nCatalog names should only contain lowercase letters, numbers, and hyphens.\n\nTo see all available catalogs, run:\n  python3 rbac-manager.py list-catalogs\nError: Catalog name 'openshift redhat operators' contains invalid characters.\nCatalog names should only contain lowercase letters, numbers, and hyphens.\n\nTo see all available catalogs, run:\n  python3 rbac-manager.py list-catalogs\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift redhat operators --package quay-operator",
        "json_data": null,
        "exit_code": 0
      }
    },
    {
      "test": "ssl_error_handling",
      "success": true,
      "details": {
        "exit_code": 0,
        "stdout": "2025-10-16 16:45:59 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:59 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:59 - INFO - Setting up port-forward to catalogd service...\n2025-10-16 16:45:59 - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1000)'))': /api/v1/namespaces/openshift-catalogd/services\n2025-10-16 16:45:59 - WARNING - Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1000)'))': /api/v1/namespaces/openshift-catalogd/services\n2025-10-16 16:45:59 - WARNING - Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: self-signed certificate in certificate chain (_ssl.c:1000)'))': /api/v1/namespaces/openshift-catalogd/services\n",
        "stderr": "2025-10-16 16:45:59 - ERROR - Failed to establish port-forward: SSL certificate verification failed. The OpenShift cluster is using self-signed certificates.\nTo resolve this issue, add the --skip-tls flag to your command.\nExample: python3 rbac-manager.py catalogd --skip-tls [other options]\n2025-10-16 16:45:59 - ERROR - Error querying catalogd: Failed to establish port-forward: SSL certificate verification failed. The OpenShift cluster is using self-signed certificates.\nTo resolve this issue, add the --skip-tls flag to your command.\nExample: python3 rbac-manager.py catalogd --skip-tls [other options]\nError: Failed to establish port-forward: SSL certificate verification failed. The OpenShift cluster is using self-signed certificates.\nTo resolve this issue, add the --skip-tls flag to your command.\nExample: python3 rbac-manager.py catalogd --skip-tls [other options]\n",
        "ssl_error_detected": true,
        "helpful_message_shown": true,
        "error_type": "SSL_CERTIFICATE_ERROR",
        "error_message": "SSL certificate verification failed as expected",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --catalog-name openshift-redhat-operators --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED***"
      }
    },
    {
      "test": "output_truncation_handling",
      "success": false,
      "details": {
        "success": true,
        "returncode": 0,
        "stdout": "2025-10-16 16:45:59 - INFO - Using provided OpenShift URL and token for authentication\n2025-10-16 16:45:59 - INFO - Successfully configured Kubernetes client for https://api.****.com:***\n2025-10-16 16:45:59 - INFO - Setting up port-forward to catalogd service...\n",
        "stderr": "2025-10-16 16:45:59 - ERROR - Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c37d4d73-ff07-46ef-9c12-78fc37def9e0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:59 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n2025-10-16 16:45:59 - ERROR - Error querying catalogd: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c37d4d73-ff07-46ef-9c12-78fc37def9e0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:59 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\nError: Failed to establish port-forward: Failed to discover catalogd service: (403)\nReason: Forbidden\nHTTP response headers: HTTPHeaderDict({'Audit-Id': 'c37d4d73-ff07-46ef-9c12-78fc37def9e0', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Content-Type-Options': 'nosniff', 'X-Kubernetes-Pf-Flowschema-Uid': 'ee4e3456-edce-4212-8dc4-ed7766bbff39', 'X-Kubernetes-Pf-Prioritylevel-Uid': '54a6df90-deb2-4dbe-8d30-3964b3cf39d0', 'Date': 'Thu, 16 Oct 2025 13:45:59 GMT', 'Content-Length': '276'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"services is forbidden: User \\\"olmadmin\\\" cannot list resource \\\"services\\\" in API group \\\"\\\" in the namespace \\\"openshift-catalogd\\\"\",\"reason\":\"Forbidden\",\"details\":{\"kind\":\"services\"},\"code\":403}\n\n\n",
        "command": "python3 tools/rbac-manager/rbac-manager.py catalogd --openshift-url https://api.example.com:6443 --openshift-token sha256~***MASKED*** --skip-tls --catalog-name openshift-redhat-operators --package quay-operator --channel stable-3.10 --version 3.10.0",
        "json_data": null,
        "exit_code": 0
      }
    }
  ]
}